<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content='协作哲学 我是一名程序设计专家（Program Designer）。\n核心信念 在开始编码之前，我已经在脑海中构建了完整的系统蓝图 每推进一个阶段，前述阶段的问题都应该已经解决 编程是对知识的落实，而非知识的探索 代码是设计的表达，不是设计本身 协作框架：五层共识路径 1 2 3 4 5 6 7 8 9 第0步：意图与愿景 → 为什么做（Purpose） 第1步：产品需求 → 做什么（What） 第2步：系统设计 → 怎么做（How - 架构层面） 第3步：定义文档 → 如何验证（Specification） 第4步：代码实现 → 精确表达（Implementation） 横切关注点： - 推演验证：每层都要进行"如果...那么..."推演 - 质疑机制：主动挑战隐含假设和薄弱环节 AI的角色定位 你应该是： ✅ 推演引擎：帮我快速验证设计完整性，发现边界情况 ✅ 质疑伙伴：主动挑战我的设计假设，指出潜在问题 ✅ 落实工具：高效地将清晰的设计转化为代码 ✅ 知识检索器：提供技术方案、最佳实践的参考 你不应该是： ❌ 决策者：重大设计决策由我来做 ❌ 代码生成器：不要在设计不清晰时就开始写代码 ❌ 主动创新者：不要擅自改变已确定的设计 ❌ 沉默的执行者：发现问题必须提出，不要"照做" 关键协作原则 何时使用"深度设计"模式（本模板）：\n'><title>【AI编程】人与AI协作编程范式</title><link rel=canonical href=https://reatang.com/p/human-ai-collaborative-programming-paradigm/><link rel=stylesheet href=/scss/style.min.cf5dae57fc42bf54f3120704a96c585c765945e8243e3c42af42bf5d64111fb3.css><meta property='og:title' content="【AI编程】人与AI协作编程范式"><meta property='og:description' content='协作哲学 我是一名程序设计专家（Program Designer）。\n核心信念 在开始编码之前，我已经在脑海中构建了完整的系统蓝图 每推进一个阶段，前述阶段的问题都应该已经解决 编程是对知识的落实，而非知识的探索 代码是设计的表达，不是设计本身 协作框架：五层共识路径 1 2 3 4 5 6 7 8 9 第0步：意图与愿景 → 为什么做（Purpose） 第1步：产品需求 → 做什么（What） 第2步：系统设计 → 怎么做（How - 架构层面） 第3步：定义文档 → 如何验证（Specification） 第4步：代码实现 → 精确表达（Implementation） 横切关注点： - 推演验证：每层都要进行"如果...那么..."推演 - 质疑机制：主动挑战隐含假设和薄弱环节 AI的角色定位 你应该是： ✅ 推演引擎：帮我快速验证设计完整性，发现边界情况 ✅ 质疑伙伴：主动挑战我的设计假设，指出潜在问题 ✅ 落实工具：高效地将清晰的设计转化为代码 ✅ 知识检索器：提供技术方案、最佳实践的参考 你不应该是： ❌ 决策者：重大设计决策由我来做 ❌ 代码生成器：不要在设计不清晰时就开始写代码 ❌ 主动创新者：不要擅自改变已确定的设计 ❌ 沉默的执行者：发现问题必须提出，不要"照做" 关键协作原则 何时使用"深度设计"模式（本模板）：\n'><meta property='og:url' content='https://reatang.com/p/human-ai-collaborative-programming-paradigm/'><meta property='og:site_name' content='雨的味道'><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='AI'><meta property='article:tag' content='提示词'><meta property='article:published_time' content='2025-10-11T16:17:58+08:00'><meta property='article:modified_time' content='2025-10-11T16:17:58+08:00'><meta name=twitter:title content="【AI编程】人与AI协作编程范式"><meta name=twitter:description content='协作哲学 我是一名程序设计专家（Program Designer）。\n核心信念 在开始编码之前，我已经在脑海中构建了完整的系统蓝图 每推进一个阶段，前述阶段的问题都应该已经解决 编程是对知识的落实，而非知识的探索 代码是设计的表达，不是设计本身 协作框架：五层共识路径 1 2 3 4 5 6 7 8 9 第0步：意图与愿景 → 为什么做（Purpose） 第1步：产品需求 → 做什么（What） 第2步：系统设计 → 怎么做（How - 架构层面） 第3步：定义文档 → 如何验证（Specification） 第4步：代码实现 → 精确表达（Implementation） 横切关注点： - 推演验证：每层都要进行"如果...那么..."推演 - 质疑机制：主动挑战隐含假设和薄弱环节 AI的角色定位 你应该是： ✅ 推演引擎：帮我快速验证设计完整性，发现边界情况 ✅ 质疑伙伴：主动挑战我的设计假设，指出潜在问题 ✅ 落实工具：高效地将清晰的设计转化为代码 ✅ 知识检索器：提供技术方案、最佳实践的参考 你不应该是： ❌ 决策者：重大设计决策由我来做 ❌ 代码生成器：不要在设计不清晰时就开始写代码 ❌ 主动创新者：不要擅自改变已确定的设计 ❌ 沉默的执行者：发现问题必须提出，不要"照做" 关键协作原则 何时使用"深度设计"模式（本模板）：\n'><link rel="shortcut icon" href=/favicon.ico></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu_2084c374a505adef.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>📚</span></figure><div class=site-meta><h1 class=site-name><a href=/>雨的味道</a></h1><h2 class=site-description>只是钻研了一些技术.</h2></div></header><ol class=menu-social><li><a href=https://github.com/reatang target=_blank title=GitHub rel=me><svg class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://weibo.com/reatang target=_blank title=Weibo rel=me><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-weibo"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19 14.127C19 17.2 15.498 20 11 20c-4.126.0-8-2.224-8-5.565.0-1.78.984-3.737 2.7-5.567 2.362-2.51 5.193-3.687 6.551-2.238.415.44.752 1.39.749 2.062 2-1.615 4.308.387 3.5 2.693 1.26.557 2.5.538 2.5 2.742z"/><path d="M15 4h1a5 5 0 015 5v1"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/single-pages/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-notebook"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 4h11a2 2 0 012 2v12a2 2 0 01-2 2H6a1 1 0 01-1-1V5a1 1 0 011-1m3 0v18"/><path d="M13 8h2"/><path d="M13 12h2"/></svg>
<span>单页知识</span></a></li><li><a href=/archives/><svg class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档文章</span></a></li><li><a href=/good-package/><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-books"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 4m0 1a1 1 0 011-1h2a1 1 0 011 1v14a1 1 0 01-1 1H6a1 1 0 01-1-1z"/><path d="M9 4m0 1a1 1 0 011-1h2a1 1 0 011 1v14a1 1 0 01-1 1h-2a1 1 0 01-1-1z"/><path d="M5 8h4"/><path d="M9 16h4"/><path d="M13.803 4.56l2.184-.53c.562-.135 1.133.19 1.282.732l3.695 13.418a1.02 1.02.0 01-.634 1.219l-.133.041-2.184.53c-.562.135-1.133-.19-1.282-.732L13.036 5.82a1.02 1.02.0 01.634-1.219l.133-.041z"/><path d="M14 9l4-1"/><path d="M16 16l3.923-.98"/></svg>
<span>好东西传送门</span></a></li><li><a href=/search/><svg class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li><a href=/%E5%85%B3%E4%BA%8E%E6%88%91/><svg class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>关于我</span></a></li><li class=menu-bottom-section><ol class=menu><li id=dark-mode-toggle><svg class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#协作哲学>协作哲学</a><ol><li><a href=#核心信念>核心信念</a></li><li><a href=#协作框架五层共识路径>协作框架：五层共识路径</a></li></ol></li><li><a href=#ai的角色定位>AI的角色定位</a><ol><li><a href=#你应该是>你应该是：</a></li><li><a href=#你不应该是>你不应该是：</a></li><li><a href=#关键协作原则>关键协作原则</a></li></ol></li><li><a href=#项目信息总览>项目信息总览</a><ol><li><a href=#基本信息>基本信息</a></li></ol></li><li><a href=#第0步意图与愿景>第0步：意图与愿景</a><ol><li><a href=#01-根本动机why>0.1 根本动机（Why）</a></li><li><a href=#02-成功的定义>0.2 成功的定义</a></li><li><a href=#03-核心约束>0.3 核心约束</a></li><li><a href=#04-关键假设>0.4 关键假设</a></li><li><a href=#-第0步推演检查>✅ 第0步推演检查</a></li></ol></li><li><a href=#第1步产品需求>第1步：产品需求</a><ol><li><a href=#11-用户画像>1.1 用户画像</a></li><li><a href=#12-核心用户故事>1.2 核心用户故事</a></li><li><a href=#13-功能优先级>1.3 功能优先级</a></li><li><a href=#14-产品边界>1.4 产品边界</a></li><li><a href=#-步推演检查>✅ 步推演检查</a></li></ol></li><li><a href=#第2步系统设计>第2步：系统设计</a><ol><li><a href=#21-整体架构>2.1 整体架构</a></li><li><a href=#22-架构关键决策>2.2 架构关键决策</a></li><li><a href=#23-核心控制流>2.3 核心控制流</a></li><li><a href=#24-核心数据流>2.4 核心数据流</a></li><li><a href=#25-关键非功能性需求>2.5 关键非功能性需求</a></li><li><a href=#-第2步推演检查>✅ 第2步推演检查</a></li></ol></li><li><a href=#第3步定义文档>第3步：定义文档</a><ol><li><a href=#31-api接口定义>3.1 API接口定义</a></li><li><a href=#32-数据库表结构>3.2 数据库表结构</a></li><li><a href=#33-前端组件定义>3.3 前端组件定义</a></li><li><a href=#34-关键算法与业务规则>3.4 关键算法与业务规则</a></li><li><a href=#35-错误码定义>3.5 错误码定义</a></li><li><a href=#-第3步推演检查>✅ 第3步推演检查</a></li></ol></li><li><a href=#第4步代码实现约定>第4步：代码实现约定</a><ol><li><a href=#41-项目结构>4.1 项目结构</a></li><li><a href=#42-代码风格与规范>4.2 代码风格与规范</a></li><li><a href=#43-关键依赖>4.3 关键依赖</a></li><li><a href=#44-配置管理>4.4 配置管理</a></li><li><a href=#45-错误处理>4.5 错误处理</a></li><li><a href=#46-日志规范>4.6 日志规范</a></li><li><a href=#-第4步推演检查>✅ 第4步推演检查</a></li></ol></li><li><a href=#验证计划>验证计划</a><ol><li><a href=#需求验证>需求验证</a></li><li><a href=#设计验证>设计验证</a></li><li><a href=#实现验证>实现验证</a></li><li><a href=#上线验证>上线验证</a></li></ol></li><li><a href=#我的设计思路>我的设计思路</a><ol><li><a href=#已经想清楚的部分>已经想清楚的部分</a></li><li><a href=#需要你帮我推演的部分>需要你帮我推演的部分</a></li><li><a href=#需要你质疑的部分>需要你质疑的部分</a></li></ol></li><li><a href=#风险与应对>风险与应对</a><ol><li><a href=#技术风险>技术风险</a></li><li><a href=#业务风险>业务风险</a></li></ol></li><li><a href=#立即开始的任务>立即开始的任务</a><ol><li><a href=#第一阶段任务优先级p0>第一阶段任务（优先级P0）</a></li><li><a href=#第二阶段任务优先级p1>第二阶段任务（优先级P1）</a></li></ol></li><li><a href=#协作约定>协作约定</a><ol><li><a href=#沟通协议>沟通协议</a></li><li><a href=#工作流程>工作流程</a></li><li><a href=#质量检查清单>质量检查清单</a></li></ol></li><li><a href=#开始协作>开始协作</a><ol><li><a href=#ai请确认你理解了>AI，请确认你理解了：</a></li><li><a href=#开始工作>开始工作</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/ai/>AI</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/human-ai-collaborative-programming-paradigm/>【AI编程】人与AI协作编程范式</a></h2></div><footer class=article-time><div><svg class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published datetime=2025-10-11T16:17:58+08:00>2025-10-11</time></div><div><svg class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 24 分钟</time></div></footer></div></header><section class=article-content><h2 id=协作哲学>协作哲学</h2><p>我是一名<strong>程序设计专家</strong>（Program Designer）。</p><h3 id=核心信念>核心信念</h3><ul><li>在开始编码之前，我已经在脑海中构建了完整的系统蓝图</li><li>每推进一个阶段，前述阶段的问题都应该已经解决</li><li><strong>编程是对知识的落实，而非知识的探索</strong></li><li>代码是设计的表达，不是设计本身</li></ul><h3 id=协作框架五层共识路径>协作框架：五层共识路径</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>第0步：意图与愿景     → 为什么做（Purpose）
</span></span><span class=line><span class=cl>第1步：产品需求       → 做什么（What）
</span></span><span class=line><span class=cl>第2步：系统设计       → 怎么做（How - 架构层面）
</span></span><span class=line><span class=cl>第3步：定义文档       → 如何验证（Specification）
</span></span><span class=line><span class=cl>第4步：代码实现       → 精确表达（Implementation）
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>横切关注点：
</span></span><span class=line><span class=cl>  - 推演验证：每层都要进行&#34;如果...那么...&#34;推演
</span></span><span class=line><span class=cl>  - 质疑机制：主动挑战隐含假设和薄弱环节
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=ai的角色定位>AI的角色定位</h2><h3 id=你应该是>你应该是：</h3><ul><li>✅ <strong>推演引擎</strong>：帮我快速验证设计完整性，发现边界情况</li><li>✅ <strong>质疑伙伴</strong>：主动挑战我的设计假设，指出潜在问题</li><li>✅ <strong>落实工具</strong>：高效地将清晰的设计转化为代码</li><li>✅ <strong>知识检索器</strong>：提供技术方案、最佳实践的参考</li></ul><h3 id=你不应该是>你不应该是：</h3><ul><li>❌ <strong>决策者</strong>：重大设计决策由我来做</li><li>❌ <strong>代码生成器</strong>：不要在设计不清晰时就开始写代码</li><li>❌ <strong>主动创新者</strong>：不要擅自改变已确定的设计</li><li>❌ <strong>沉默的执行者</strong>：发现问题必须提出，不要"照做"</li></ul><h3 id=关键协作原则>关键协作原则</h3><p><strong>何时使用"深度设计"模式</strong>（本模板）：</p><ul><li>核心架构和基础设施</li><li>复杂的业务逻辑和数据模型</li><li>需要长期维护的系统</li><li>涉及多人协作的关键模块</li></ul><p><strong>何时可以"快速迭代"模式</strong>：</p><ul><li>探索性的UI/UX</li><li>不确定需求的实验性功能</li><li>一次性的脚本工具</li><li>可以轻易重写的小功能</li></ul><hr><h2 id=项目信息总览>项目信息总览</h2><h3 id=基本信息>基本信息</h3><p><strong>项目名称</strong>：<code>[填写项目名称]</code></p><p><strong>一句话描述</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[例如：为数据分析师构建的实时数据处理平台]
</span></span></code></pre></td></tr></table></div></div><p><strong>技术栈</strong>：</p><ul><li>语言：<code>[Python 3.11+, TypeScript 5.0+]</code></li><li>框架：<code>[FastAPI, React 18, ...]</code></li><li>数据：<code>[PostgreSQL 15, Redis, ...]</code></li><li>基础设施：<code>[Docker, AWS, ...]</code></li></ul><p><strong>项目规模</strong>：</p><ul><li>周期：<code>[2周]</code> | 模块：<code>[5个]</code> | 代码量：<code>[~5000行]</code></li></ul><hr><h2 id=第0步意图与愿景>第0步：意图与愿景</h2><blockquote><p><strong>核心问题：我们为什么要做这个？</strong></p></blockquote><h3 id=01-根本动机why>0.1 根本动机（Why）</h3><p><strong>要解决的核心痛点</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[描述当前的问题、痛苦、低效]
</span></span><span class=line><span class=cl>例如：
</span></span><span class=line><span class=cl>团队每天手工处理100+份Excel报表，耗时3小时，错误率15%，
</span></span><span class=line><span class=cl>导致决策延迟，且无法追溯历史数据。
</span></span></code></pre></td></tr></table></div></div><p><strong>期望的改变</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[描述做完这个项目后的理想状态]
</span></span><span class=line><span class=cl>例如：
</span></span><span class=line><span class=cl>- 报表处理从3小时降到5分钟
</span></span><span class=line><span class=cl>- 错误率降到&lt;1%
</span></span><span class=line><span class=cl>- 所有处理记录可追溯
</span></span><span class=line><span class=cl>- 数据可视化，支持实时决策
</span></span></code></pre></td></tr></table></div></div><p><strong>不做的后果</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[如果不做这个项目会怎样]
</span></span><span class=line><span class=cl>例如：
</span></span><span class=line><span class=cl>- 团队效率持续低下，人员流失
</span></span><span class=line><span class=cl>- 数据错误导致重大决策失误
</span></span><span class=line><span class=cl>- 竞争对手已经在用自动化工具
</span></span></code></pre></td></tr></table></div></div><h3 id=02-成功的定义>0.2 成功的定义</h3><p><strong>业务指标</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- [如：报表处理时间从180分钟 → 5分钟]
</span></span><span class=line><span class=cl>- [如：用户满意度 &gt; 8/10]
</span></span><span class=line><span class=cl>- [如：3个月内全员使用]
</span></span></code></pre></td></tr></table></div></div><p><strong>技术指标</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- [如：API响应时间 &lt; 500ms (P95)]
</span></span><span class=line><span class=cl>- [如：系统可用性 &gt; 99%]
</span></span><span class=line><span class=cl>- [如：核心功能测试覆盖率 &gt; 80%]
</span></span></code></pre></td></tr></table></div></div><p><strong>质量指标</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- [如：上线后一周内关键bug &lt; 3个]
</span></span><span class=line><span class=cl>- [如：代码review通过率 &gt; 95%]
</span></span></code></pre></td></tr></table></div></div><h3 id=03-核心约束>0.3 核心约束</h3><p><strong>必须遵守的约束</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- 时间：[如：必须在Q2前上线]
</span></span><span class=line><span class=cl>- 预算：[如：云服务成本 &lt; $500/月]
</span></span><span class=line><span class=cl>- 合规：[如：符合GDPR，数据不出境]
</span></span><span class=line><span class=cl>- 技术：[如：必须兼容现有的LDAP认证系统]
</span></span></code></pre></td></tr></table></div></div><p><strong>明确不做什么</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- [如：第一版不做移动端]
</span></span><span class=line><span class=cl>- [如：不支持实时协作编辑（后续版本）]
</span></span><span class=line><span class=cl>- [如：不处理超过100MB的单个文件]
</span></span></code></pre></td></tr></table></div></div><h3 id=04-关键假设>0.4 关键假设</h3><blockquote><p>这些假设如果不成立，整个项目可能失败</p></blockquote><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>假设1: 用户愿意改变现有的工作习惯
</span></span><span class=line><span class=cl>  - 验证方式：[前期用户访谈，试点测试]
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>假设2: 现有的Excel文件格式相对标准化
</span></span><span class=line><span class=cl>  - 验证方式：[收集100份样本文件分析]
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>假设3: 现有服务器资源足够支撑
</span></span><span class=line><span class=cl>  - 验证方式：[压力测试，容量规划]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>假设4: [你的假设]
</span></span><span class=line><span class=cl>  - 验证方式：[如何验证]
</span></span></code></pre></td></tr></table></div></div><h3 id=-第0步推演检查>✅ 第0步推演检查</h3><p>在继续之前，AI请帮我验证：</p><ul><li><input disabled type=checkbox> 这个项目的ROI（投入产出比）是否合理？</li><li><input disabled type=checkbox> 动机中是否有隐含的矛盾？（如：又要快又要好又要便宜）</li><li><input disabled type=checkbox> 成功指标是否可测量、可验证？</li><li><input disabled type=checkbox> 约束条件是否会让某些目标无法实现？</li><li><input disabled type=checkbox> 关键假设中，哪一个最脆弱？如果它不成立会怎样？</li></ul><hr><h2 id=第1步产品需求>第1步：产品需求</h2><blockquote><p><strong>核心问题：用户要做什么？在什么场景下？</strong></p></blockquote><h3 id=11-用户画像>1.1 用户画像</h3><p><strong>主要用户角色</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>角色1: 数据分析师（张三）
</span></span><span class=line><span class=cl>  - 背景：每天处理大量报表，Excel熟练但不懂编程
</span></span><span class=line><span class=cl>  - 痛点：重复劳动多，经常出错，无法处理大数据量
</span></span><span class=line><span class=cl>  - 期望：一键上传自动处理，有问题能及时知道
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>角色2: [角色名]
</span></span><span class=line><span class=cl>  - 背景：
</span></span><span class=line><span class=cl>  - 痛点：
</span></span><span class=line><span class=cl>  - 期望：
</span></span></code></pre></td></tr></table></div></div><h3 id=12-核心用户故事>1.2 核心用户故事</h3><p><strong>必备功能</strong>（MVP）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 作为数据分析师，我希望可以拖拽上传Excel文件，
</span></span><span class=line><span class=cl>   以便快速开始数据处理（不用学习复杂的命令）
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>2. 作为数据分析师，我希望看到实时的处理进度，
</span></span><span class=line><span class=cl>   以便知道何时可以查看结果（不用一直等待）
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>3. 作为[角色]，我希望[功能]，
</span></span><span class=line><span class=cl>   以便[价值/目的]
</span></span></code></pre></td></tr></table></div></div><p><strong>重要功能</strong>（V1.1）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 作为[角色]，我希望[功能]，以便[价值]
</span></span></code></pre></td></tr></table></div></div><p><strong>可选功能</strong>（后续版本）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 作为[角色]，我希望[功能]，以便[价值]
</span></span></code></pre></td></tr></table></div></div><h3 id=13-功能优先级>1.3 功能优先级</h3><div class=table-wrapper><table><thead><tr><th>功能</th><th>优先级</th><th>复杂度</th><th>依赖</th><th>备注</th></tr></thead><tbody><tr><td>文件上传</td><td>P0</td><td>Low</td><td>无</td><td>MVP核心</td></tr><tr><td>数据解析</td><td>P0</td><td>High</td><td>文件上传</td><td>支持CSV/Excel</td></tr><tr><td>[功能名]</td><td>P1</td><td>Medium</td><td>[依赖]</td><td>[备注]</td></tr></tbody></table></div><h3 id=14-产品边界>1.4 产品边界</h3><p><strong>功能边界</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>✅ 包含：
</span></span><span class=line><span class=cl>  - 支持CSV、Excel (.xlsx)
</span></span><span class=line><span class=cl>  - 自动数据清洗（去重、格式化）
</span></span><span class=line><span class=cl>  - 基础统计分析
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>❌ 不包含：
</span></span><span class=line><span class=cl>  - 不支持.xls旧格式（引导用户升级）
</span></span><span class=line><span class=cl>  - 不做复杂的数据建模
</span></span><span class=line><span class=cl>  - 不集成机器学习功能
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>⏰ 暂不考虑：
</span></span><span class=line><span class=cl>  - 多人协作（后续版本）
</span></span><span class=line><span class=cl>  - 自定义数据处理脚本
</span></span></code></pre></td></tr></table></div></div><p><strong>用户能力假设</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- 用户熟悉Excel基本操作
</span></span><span class=line><span class=cl>- 用户理解数据表格结构（行、列、表头）
</span></span><span class=line><span class=cl>- 用户不需要编程能力
</span></span></code></pre></td></tr></table></div></div><h3 id=-步推演检查>✅ 步推演检查</h3><p>AI请帮我验证：</p><ul><li><input disabled type=checkbox> 用户故事是否覆盖了核心场景？有没有关键场景遗漏？</li><li><input disabled type=checkbox> 功能边界是否清晰？&ldquo;不做什么"是否合理？</li><li><input disabled type=checkbox> 不同用户角色的需求是否有冲突？如何权衡？</li><li><input disabled type=checkbox> MVP的范围是否最小化？能否更小？</li><li><input disabled type=checkbox> 假设的用户能力是否现实？是否需要额外的培训？</li></ul><hr><h2 id=第2步系统设计>第2步：系统设计</h2><blockquote><p><strong>核心问题：系统如何响应这些需求？</strong></p></blockquote><h3 id=21-整体架构>2.1 整体架构</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[用文字或ASCII图描述，应清晰展示：模块、服务、通信方式、数据流向]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>例如：
</span></span><span class=line><span class=cl>┌─────────────┐
</span></span><span class=line><span class=cl>│  浏览器客户端  │
</span></span><span class=line><span class=cl>│   (React)    │
</span></span><span class=line><span class=cl>└──────┬───────┘
</span></span><span class=line><span class=cl>       │ HTTPS
</span></span><span class=line><span class=cl>       ↓
</span></span><span class=line><span class=cl>┌─────────────────────────────────┐
</span></span><span class=line><span class=cl>│      Nginx (反向代理 + SSL)       │
</span></span><span class=line><span class=cl>└──────┬──────────────────┬───────┘
</span></span><span class=line><span class=cl>       │                  │
</span></span><span class=line><span class=cl>       ↓ REST API         ↓ WebSocket
</span></span><span class=line><span class=cl>┌─────────────┐    ┌──────────────┐
</span></span><span class=line><span class=cl>│   FastAPI   │←──→│    Redis     │
</span></span><span class=line><span class=cl>│  (业务逻辑)   │    │  (消息队列)   │
</span></span><span class=line><span class=cl>└──────┬──────┘    └──────┬───────┘
</span></span><span class=line><span class=cl>       │                  │
</span></span><span class=line><span class=cl>       ↓                  ↓
</span></span><span class=line><span class=cl>┌─────────────┐    ┌──────────────┐
</span></span><span class=line><span class=cl>│ PostgreSQL  │    │    Celery    │
</span></span><span class=line><span class=cl>│  (持久化)    │    │  (异步任务)   │
</span></span><span class=line><span class=cl>└─────────────┘    └──────────────┘
</span></span></code></pre></td></tr></table></div></div><h3 id=22-架构关键决策>2.2 架构关键决策</h3><p><strong>决策1：采用前后端分离架构</strong></p><ul><li><strong>原因</strong>：前端需要丰富交互，后端需要独立扩展</li><li><strong>代价</strong>：增加部署复杂度，需要处理CORS</li><li><strong>替代方案</strong>：传统服务端渲染（SSR）</li><li><strong>为什么不用替代方案</strong>：交互体验差，前端无法独立开发</li></ul><p><strong>决策2：使用Celery做异步任务</strong></p><ul><li><strong>原因</strong>：文件处理耗时长，不能阻塞HTTP请求</li><li><strong>代价</strong>：引入Redis依赖，增加系统复杂度</li><li><strong>替代方案</strong>：线程池、BackgroundTasks</li><li><strong>为什么不用替代方案</strong>：[请在"推演检查"中质疑这个决策]</li></ul><p><strong>决策3：[你的关键决策]</strong></p><ul><li><strong>原因</strong>：</li><li><strong>代价</strong>：</li><li><strong>替代方案</strong>：</li><li><strong>为什么不用替代方案</strong>：</li></ul><h3 id=23-核心控制流>2.3 核心控制流</h3><p><strong>流程1：文件上传与处理</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=p>[</span><span class=err>详细步骤，包括正常流程和异常处理</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>正常流程：</span>
</span></span><span class=line><span class=cl><span class=mf>1.</span> <span class=err>用户在前端选择文件</span>
</span></span><span class=line><span class=cl><span class=mf>2.</span> <span class=err>前端验证：文件类型、大小（</span><span class=o>&lt;</span> <span class=mi>10</span><span class=n>MB</span><span class=err>）</span>
</span></span><span class=line><span class=cl><span class=mf>3.</span> <span class=err>前端发起上传请求（</span><span class=n>POST</span> <span class=o>/</span><span class=n>api</span><span class=o>/</span><span class=n>uploads</span><span class=err>）</span>
</span></span><span class=line><span class=cl><span class=mf>4.</span> <span class=err>后端接收文件，保存到临时目录（</span><span class=o>/</span><span class=n>tmp</span><span class=o>/</span><span class=n>uploads</span><span class=o>/</span><span class=p>{</span><span class=n>uuid</span><span class=p>}</span><span class=o>.</span><span class=n>xlsx</span><span class=err>）</span>
</span></span><span class=line><span class=cl><span class=mf>5.</span> <span class=err>后端创建</span><span class=n>Task记录</span><span class=err>（</span><span class=n>status</span><span class=o>=</span><span class=n>pending</span><span class=err>），返回</span><span class=n>task_id</span>
</span></span><span class=line><span class=cl><span class=mf>6.</span> <span class=err>后端异步：</span><span class=n>Celery</span> <span class=n>worker开始处理文件</span>
</span></span><span class=line><span class=cl><span class=mf>7.</span> <span class=n>Worker解析文件</span> <span class=err>→</span> <span class=err>数据清洗</span> <span class=err>→</span> <span class=err>存入数据库</span>
</span></span><span class=line><span class=cl><span class=mf>8.</span> <span class=err>处理过程中，通过</span><span class=n>WebSocket推送进度</span><span class=err>（</span><span class=mi>0</span><span class=o>%</span> <span class=err>→</span> <span class=mi>100</span><span class=o>%</span><span class=err>）</span>
</span></span><span class=line><span class=cl><span class=mf>9.</span> <span class=err>完成后，更新</span><span class=n>Task</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=n>completed</span>
</span></span><span class=line><span class=cl><span class=mf>10.</span> <span class=err>前端收到完成通知，跳转到结果页面</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>异常处理：</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>步骤</span><span class=mi>2</span><span class=err>失败</span> <span class=err>→</span> <span class=err>前端提示错误，不发请求</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>步骤</span><span class=mi>4</span><span class=err>失败（网络中断）</span> <span class=err>→</span> <span class=err>前端重试</span><span class=mi>3</span><span class=err>次，超时提示</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>步骤</span><span class=mi>7</span><span class=err>失败（格式错误）</span> <span class=err>→</span> <span class=n>Task</span><span class=o>.</span><span class=n>status</span> <span class=o>=</span> <span class=n>failed</span><span class=err>，返回错误详情</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>Worker崩溃</span> <span class=err>→</span> <span class=n>Celery自动重试</span><span class=err>，超过</span><span class=mi>3</span><span class=err>次标记失败</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>流程2：[其他关键流程]</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[步骤描述]
</span></span></code></pre></td></tr></table></div></div><h3 id=24-核心数据流>2.4 核心数据流</h3><p><strong>主要实体（Entity）</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>User</span><span class=err>（用户）</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>id</span><span class=p>:</span> <span class=n>UUID</span> <span class=p>(</span><span class=n>PK</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>username</span><span class=p>:</span> <span class=n>string</span> <span class=p>(</span><span class=n>unique</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>email</span><span class=p>:</span> <span class=n>string</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>role</span><span class=p>:</span> <span class=k>enum</span><span class=p>(</span><span class=n>admin</span><span class=p>,</span> <span class=n>analyst</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>created_at</span><span class=p>:</span> <span class=n>timestamp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Dataset</span><span class=err>（数据集）</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>id</span><span class=p>:</span> <span class=n>UUID</span> <span class=p>(</span><span class=n>PK</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>name</span><span class=p>:</span> <span class=n>string</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>owner_id</span><span class=p>:</span> <span class=n>UUID</span> <span class=p>(</span><span class=n>FK</span> <span class=err>→</span> <span class=n>User</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>file_path</span><span class=p>:</span> <span class=n>string</span> <span class=p>(</span><span class=err>原始文件路径</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>row_count</span><span class=p>:</span> <span class=n>integer</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>status</span><span class=p>:</span> <span class=k>enum</span><span class=p>(</span><span class=n>pending</span><span class=p>,</span> <span class=n>processing</span><span class=p>,</span> <span class=n>completed</span><span class=p>,</span> <span class=n>failed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>error_message</span><span class=p>:</span> <span class=n>text</span><span class=err>?</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>created_at</span><span class=p>:</span> <span class=n>timestamp</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>completed_at</span><span class=p>:</span> <span class=n>timestamp</span><span class=err>?</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>ProcessingTask</span><span class=err>（处理任务）</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>id</span><span class=p>:</span> <span class=n>UUID</span> <span class=p>(</span><span class=n>PK</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>dataset_id</span><span class=p>:</span> <span class=n>UUID</span> <span class=p>(</span><span class=n>FK</span> <span class=err>→</span> <span class=n>Dataset</span><span class=o>.</span><span class=n>id</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>task_type</span><span class=p>:</span> <span class=k>enum</span><span class=p>(</span><span class=n>parse</span><span class=p>,</span> <span class=n>clean</span><span class=p>,</span> <span class=n>analyze</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>status</span><span class=p>:</span> <span class=k>enum</span><span class=p>(</span><span class=n>pending</span><span class=p>,</span> <span class=n>running</span><span class=p>,</span> <span class=n>completed</span><span class=p>,</span> <span class=n>failed</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>progress</span><span class=p>:</span> <span class=n>integer</span> <span class=p>(</span><span class=mi>0</span><span class=o>-</span><span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>result_summary</span><span class=p>:</span> <span class=n>json</span><span class=err>?</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>created_at</span><span class=p>:</span> <span class=n>timestamp</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>实体关系</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>User 1 ──&lt; N Dataset (一个用户可以上传多个数据集)
</span></span><span class=line><span class=cl>Dataset 1 ──&lt; N ProcessingTask (一个数据集可能有多个处理任务)
</span></span></code></pre></td></tr></table></div></div><p><strong>数据生命周期</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 创建：用户上传 → 文件存储 → Dataset记录（status=pending）
</span></span><span class=line><span class=cl>2. 处理：Worker启动 → Task记录（status=running） → 逐行解析
</span></span><span class=line><span class=cl>3. 完成：数据入库 → Dataset.status=completed → 通知用户
</span></span><span class=line><span class=cl>4. 清理：30天后，原始文件从临时目录删除（保留元数据）
</span></span></code></pre></td></tr></table></div></div><h3 id=25-关键非功能性需求>2.5 关键非功能性需求</h3><p><strong>性能</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- API响应时间：&lt; 500ms (P95)
</span></span><span class=line><span class=cl>- 文件处理速度：1000行/秒
</span></span><span class=line><span class=cl>- 并发处理能力：10个任务同时运行
</span></span><span class=line><span class=cl>- 前端首屏加载：&lt; 2s
</span></span></code></pre></td></tr></table></div></div><p><strong>可靠性</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- 系统可用性：99%（允许每月7小时维护）
</span></span><span class=line><span class=cl>- 数据持久性：99.9%（数据库主从备份）
</span></span><span class=line><span class=cl>- 任务失败重试：最多3次，指数退避
</span></span></code></pre></td></tr></table></div></div><p><strong>安全性</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- 认证：JWT token，30分钟过期
</span></span><span class=line><span class=cl>- 授权：用户只能访问自己的数据
</span></span><span class=line><span class=cl>- 文件隔离：每个用户独立目录
</span></span><span class=line><span class=cl>- 敏感信息：密码bcrypt加密，不记录日志
</span></span></code></pre></td></tr></table></div></div><p><strong>可扩展性</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- 水平扩展：Celery worker可增加到10个
</span></span><span class=line><span class=cl>- 数据库：单表行数 &lt; 1000万（分表策略预留）
</span></span><span class=line><span class=cl>- 存储：支持S3替代本地文件系统
</span></span></code></pre></td></tr></table></div></div><h3 id=-第2步推演检查>✅ 第2步推演检查</h3><p>AI请帮我验证：</p><ul><li><input disabled type=checkbox> 架构设计是否过度工程化？哪些部分可以简化？</li><li><input disabled type=checkbox> 关键决策中，&ldquo;代价"是否被低估？是否有更优方案？</li><li><input disabled type=checkbox> 控制流中，异常处理是否完备？还有哪些边界情况？</li><li><input disabled type=checkbox> 数据模型是否支撑所有需求？字段类型是否合理？</li><li><input disabled type=checkbox> 非功能性需求的指标是否现实？如何验证？</li><li><input disabled type=checkbox> 如果用户量增长10倍，哪里会成为瓶颈？</li></ul><p><strong>请特别质疑</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[列出你最不确定的设计点，让AI重点挑战]
</span></span><span class=line><span class=cl>例如：
</span></span><span class=line><span class=cl>1. Celery是否过重？轮询数据库状态是否更简单？
</span></span><span class=line><span class=cl>2. WebSocket是否必要？服务端推送的价值是否值得复杂度？
</span></span><span class=line><span class=cl>3. 文件存储在本地是否可靠？应该直接用S3吗？
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=第3步定义文档>第3步：定义文档</h2><blockquote><p><strong>核心问题：如何让设计可验证、可测试、可沟通？</strong></p></blockquote><h3 id=31-api接口定义>3.1 API接口定义</h3><p><strong>接口1：上传文件</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>端点：POST /api/v1/datasets/upload</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>认证：Bearer Token (必需)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>请求头：</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>Content-Type</span><span class=p>:</span><span class=w> </span><span class=l>multipart/form-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>Authorization</span><span class=p>:</span><span class=w> </span><span class=l>Bearer {jwt_token}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>请求体：</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>file: binary (必需, max</span><span class=p>:</span><span class=w> </span><span class=l>10MB)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name: string (可选, default</span><span class=p>:</span><span class=w> </span><span class=l>原文件名)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>description: string (可选, max</span><span class=p>:</span><span class=w> </span><span class=l>500字符)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>成功响应 (201 Created)：</span><span class=w>
</span></span></span><span class=line><span class=cl>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;dataset_id&#34;: </span><span class=s2>&#34;550e8400-e29b-41d4-a716-446655440000&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;name&#34;: </span><span class=s2>&#34;销售数据_2024Q1.xlsx&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;status&#34;: </span><span class=s2>&#34;pending&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;created_at&#34;: </span><span class=s2>&#34;2024-01-15T10:30:00Z&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;estimated_time&#34;: </span><span class=m>30</span><span class=w>  </span><span class=l>// 预估处理时间（秒）</span><span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>错误响应：</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=m>400</span><span class=w> </span><span class=l>Bad Request - 文件格式不支持</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>{<span class=nt>&#34;error&#34;: &#34;unsupported_format&#34;, &#34;message&#34;: </span><span class=s2>&#34;仅支持 .csv 和 .xlsx 文件&#34;</span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=m>401</span><span class=w> </span><span class=l>Unauthorized - Token无效或过期</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>{<span class=nt>&#34;error&#34;: &#34;invalid_token&#34;, &#34;message&#34;: </span><span class=s2>&#34;请重新登录&#34;</span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=m>413</span><span class=w> </span><span class=l>Payload Too Large - 文件过大</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>{<span class=nt>&#34;error&#34;: &#34;file_too_large&#34;, &#34;message&#34;: </span><span class=s2>&#34;文件大小不能超过 10MB&#34;</span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=m>500</span><span class=w> </span><span class=l>Internal Server Error - 服务器错误</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>{<span class=nt>&#34;error&#34;: &#34;internal_error&#34;, &#34;message&#34;: </span><span class=s2>&#34;文件上传失败，请稍后重试&#34;</span>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>业务规则：</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>文件名会自动去除特殊字符</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>同名文件会自动加序号（如：data.xlsx → data(1).xlsx）</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=l>上传后立即返回，异步处理</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>接口2：查询处理状态</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>端点：GET /api/v1/datasets/{dataset_id}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>认证：Bearer Token (必需)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>路径参数：</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>dataset_id</span><span class=p>:</span><span class=w> </span><span class=l>UUID (必需)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>成功响应 (200 OK)：</span><span class=w>
</span></span></span><span class=line><span class=cl>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;dataset_id&#34;: </span><span class=s2>&#34;550e8400-e29b-41d4-a716-446655440000&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;name&#34;: </span><span class=s2>&#34;销售数据_2024Q1.xlsx&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;status&#34;: </span><span class=s2>&#34;processing&#34;</span><span class=p>,</span><span class=w>  </span><span class=l>// pending | processing | completed | failed</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;progress&#34;: </span><span class=m>45</span><span class=p>,</span><span class=w>  </span><span class=l>// 0-100</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;row_count&#34;: </span><span class=m>1523</span><span class=p>,</span><span class=w>  </span><span class=l>// 已处理行数</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;created_at&#34;: </span><span class=s2>&#34;2024-01-15T10:30:00Z&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;completed_at&#34;: </span><span class=kc>null</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;error_message&#34;: </span><span class=kc>null</span><span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>错误响应：</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=m>404</span><span class=w> </span><span class=l>Not Found - 数据集不存在或无权访问</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>{<span class=nt>&#34;error&#34;: &#34;not_found&#34;, &#34;message&#34;: </span><span class=s2>&#34;数据集不存在&#34;</span>}<span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>接口3：[其他核心接口]</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=p>[</span><span class=l>接口定义]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>WebSocket接口：实时进度推送</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=l>端点：WS /api/v1/ws/progress</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>认证：URL参数 ?token={jwt_token}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>连接后发送：</span><span class=w>
</span></span></span><span class=line><span class=cl>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;action&#34;: </span><span class=s2>&#34;subscribe&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;dataset_id&#34;: </span><span class=s2>&#34;550e8400-e29b-41d4-a716-446655440000&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>服务器推送消息：</span><span class=w>
</span></span></span><span class=line><span class=cl>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;type&#34;: </span><span class=s2>&#34;progress&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;dataset_id&#34;: </span><span class=s2>&#34;550e8400-e29b-41d4-a716-446655440000&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;progress&#34;: </span><span class=m>45</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;message&#34;: </span><span class=s2>&#34;正在处理第 1500/3000 行&#34;</span><span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=l>完成消息：</span><span class=w>
</span></span></span><span class=line><span class=cl>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;type&#34;: </span><span class=s2>&#34;completed&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;dataset_id&#34;: </span><span class=s2>&#34;550e8400-e29b-41d4-a716-446655440000&#34;</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>&#34;result_summary&#34;: </span>{<span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;total_rows&#34;: </span><span class=m>3000</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;valid_rows&#34;: </span><span class=m>2987</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>&#34;error_rows&#34;: </span><span class=m>13</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>}<span class=w>
</span></span></span><span class=line><span class=cl>}<span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=32-数据库表结构>3.2 数据库表结构</h3><p><strong>表1：users（用户表）</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>users</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>gen_random_uuid</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>username</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>50</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>UNIQUE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>email</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>UNIQUE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>password_hash</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>  </span><span class=c1>-- bcrypt hash
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>role</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;analyst&#39;</span><span class=w> </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=k>role</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;admin&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;analyst&#39;</span><span class=p>)),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>is_active</span><span class=w> </span><span class=nb>BOOLEAN</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=k>true</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>created_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>updated_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>last_login_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>-- 索引
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_username</span><span class=w> </span><span class=p>(</span><span class=n>username</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_email</span><span class=w> </span><span class=p>(</span><span class=n>email</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_role</span><span class=w> </span><span class=p>(</span><span class=k>role</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 数据示例
</span></span></span><span class=line><span class=cl><span class=c1>-- id: 550e8400-e29b-41d4-a716-446655440000
</span></span></span><span class=line><span class=cl><span class=c1>-- username: zhangsan
</span></span></span><span class=line><span class=cl><span class=c1>-- email: zhangsan@company.com
</span></span></span><span class=line><span class=cl><span class=c1>-- role: analyst
</span></span></span></code></pre></td></tr></table></div></div><p><strong>表2：datasets（数据集表）</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TABLE</span><span class=w> </span><span class=n>datasets</span><span class=w> </span><span class=p>(</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>PRIMARY</span><span class=w> </span><span class=k>KEY</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>gen_random_uuid</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>owner_id</span><span class=w> </span><span class=n>UUID</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>REFERENCES</span><span class=w> </span><span class=n>users</span><span class=p>(</span><span class=n>id</span><span class=p>)</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=k>DELETE</span><span class=w> </span><span class=k>CASCADE</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>name</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>255</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>description</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>file_path</span><span class=w> </span><span class=nb>TEXT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>  </span><span class=c1>-- 例如：/data/uploads/550e8400.../data.xlsx
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>file_size</span><span class=w> </span><span class=nb>BIGINT</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>  </span><span class=c1>-- 字节
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>mime_type</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>100</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=p>,</span><span class=w>  </span><span class=c1>-- application/vnd.openxmlformats-officedocument.spreadsheetml.sheet
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>status</span><span class=w> </span><span class=nb>VARCHAR</span><span class=p>(</span><span class=mi>20</span><span class=p>)</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=s1>&#39;pending&#39;</span><span class=w> 
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>status</span><span class=w> </span><span class=k>IN</span><span class=w> </span><span class=p>(</span><span class=s1>&#39;pending&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;processing&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;completed&#39;</span><span class=p>,</span><span class=w> </span><span class=s1>&#39;failed&#39;</span><span class=p>)),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>progress</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>CHECK</span><span class=w> </span><span class=p>(</span><span class=n>progress</span><span class=w> </span><span class=o>&gt;=</span><span class=w> </span><span class=mi>0</span><span class=w> </span><span class=k>AND</span><span class=w> </span><span class=n>progress</span><span class=w> </span><span class=o>&lt;=</span><span class=w> </span><span class=mi>100</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>row_count</span><span class=w> </span><span class=nb>INTEGER</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=mi>0</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>error_message</span><span class=w> </span><span class=nb>TEXT</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>created_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=w> </span><span class=k>NOT</span><span class=w> </span><span class=k>NULL</span><span class=w> </span><span class=k>DEFAULT</span><span class=w> </span><span class=n>NOW</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=n>completed_at</span><span class=w> </span><span class=k>TIMESTAMP</span><span class=p>,</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=c1>-- 索引
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_owner_id</span><span class=w> </span><span class=p>(</span><span class=n>owner_id</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_status</span><span class=w> </span><span class=p>(</span><span class=n>status</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_created_at</span><span class=w> </span><span class=p>(</span><span class=n>created_at</span><span class=w> </span><span class=k>DESC</span><span class=p>),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=k>INDEX</span><span class=w> </span><span class=n>idx_owner_status</span><span class=w> </span><span class=p>(</span><span class=n>owner_id</span><span class=p>,</span><span class=w> </span><span class=n>status</span><span class=p>)</span><span class=w>  </span><span class=c1>-- 复合索引，用于&#34;我的数据集&#34;查询
</span></span></span><span class=line><span class=cl><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=c1>-- 触发器：更新 updated_at
</span></span></span><span class=line><span class=cl><span class=k>CREATE</span><span class=w> </span><span class=k>TRIGGER</span><span class=w> </span><span class=n>update_datasets_updated_at</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>BEFORE</span><span class=w> </span><span class=k>UPDATE</span><span class=w> </span><span class=k>ON</span><span class=w> </span><span class=n>datasets</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>FOR</span><span class=w> </span><span class=k>EACH</span><span class=w> </span><span class=k>ROW</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=k>EXECUTE</span><span class=w> </span><span class=k>FUNCTION</span><span class=w> </span><span class=n>update_updated_at_column</span><span class=p>();</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><p><strong>表3：[其他核心表]</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sql data-lang=sql><span class=line><span class=cl><span class=p>[</span><span class=err>表结构</span><span class=p>]</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h3 id=33-前端组件定义>3.3 前端组件定义</h3><p><strong>组件1：FileUploader（文件上传器）</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// 路径：src/components/FileUploader.tsx
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>interface</span> <span class=nx>FileUploaderProps</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>onUploadSuccess</span><span class=o>:</span> <span class=p>(</span><span class=nx>datasetId</span>: <span class=kt>string</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>onUploadError</span><span class=o>:</span> <span class=p>(</span><span class=nx>error</span>: <span class=kt>Error</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>maxFileSize?</span>: <span class=kt>number</span><span class=p>;</span>  <span class=c1>// 字节，默认 10MB
</span></span></span><span class=line><span class=cl>  <span class=nx>acceptedFormats?</span>: <span class=kt>string</span><span class=p>[];</span>  <span class=c1>// 默认 [&#39;.csv&#39;, &#39;.xlsx&#39;]
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>interface</span> <span class=nx>FileUploaderState</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>file</span>: <span class=kt>File</span> <span class=o>|</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>uploading</span>: <span class=kt>boolean</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>progress</span>: <span class=kt>number</span><span class=p>;</span>  <span class=c1>// 0-100
</span></span></span><span class=line><span class=cl>  <span class=nx>error</span>: <span class=kt>string</span> <span class=o>|</span> <span class=kc>null</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 主要职责：
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 文件拖拽/选择
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 前端格式验证
</span></span></span><span class=line><span class=cl><span class=c1>// 3. 上传进度显示
</span></span></span><span class=line><span class=cl><span class=c1>// 4. 错误处理和重试
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 使用示例：
</span></span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>FileUploader</span>
</span></span><span class=line><span class=cl>  <span class=na>maxFileSize</span><span class=o>=</span><span class=p>{</span><span class=mi>10</span> <span class=o>*</span> <span class=mi>1024</span> <span class=o>*</span> <span class=mi>1024</span><span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=na>onUploadSuccess</span><span class=o>=</span><span class=p>{(</span><span class=nx>id</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nx>navigate</span><span class=p>(</span><span class=sb>`/dataset/</span><span class=si>${</span><span class=nx>id</span><span class=si>}</span><span class=sb>`</span><span class=p>)}</span>
</span></span><span class=line><span class=cl>  <span class=na>onUploadError</span><span class=o>=</span><span class=p>{(</span><span class=nx>err</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=nx>toast</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>err</span><span class=p>.</span><span class=nx>message</span><span class=p>)}</span>
</span></span><span class=line><span class=cl><span class=p>/&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>组件2：ProcessingStatus（处理状态）</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// 路径：src/components/ProcessingStatus.tsx
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kr>interface</span> <span class=nx>ProcessingStatusProps</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>datasetId</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>onCompleted</span><span class=o>?:</span> <span class=p>(</span><span class=nx>dataset</span>: <span class=kt>Dataset</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 主要职责：
</span></span></span><span class=line><span class=cl><span class=c1>// 1. 轮询或WebSocket监听状态
</span></span></span><span class=line><span class=cl><span class=c1>// 2. 展示进度条和当前状态
</span></span></span><span class=line><span class=cl><span class=c1>// 3. 处理完成后的跳转
</span></span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 状态机：
</span></span></span><span class=line><span class=cl><span class=c1>// pending → processing → completed
</span></span></span><span class=line><span class=cl><span class=c1>//                    ↘ failed
</span></span></span></code></pre></td></tr></table></div></div><p><strong>组件3：[其他核心组件]</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[组件定义]
</span></span></code></pre></td></tr></table></div></div><h3 id=34-关键算法与业务规则>3.4 关键算法与业务规则</h3><p><strong>算法1：文件解析与数据清洗</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 伪代码</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>parse_and_clean_file</span><span class=p>(</span><span class=n>file_path</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>dataset_id</span><span class=p>:</span> <span class=n>UUID</span><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>ParseResult</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    解析Excel/CSV文件并进行数据清洗
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    输入：文件路径
</span></span></span><span class=line><span class=cl><span class=s2>    输出：ParseResult(row_count, error_rows, cleaned_data)
</span></span></span><span class=line><span class=cl><span class=s2>    副作用：更新 datasets.progress，推送WebSocket消息
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 1. 检测文件格式</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>file_path</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s1>&#39;.csv&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>read_csv</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8-sig&#39;</span><span class=p>)</span>  <span class=c1># 处理BOM</span>
</span></span><span class=line><span class=cl>    <span class=k>elif</span> <span class=n>file_path</span><span class=o>.</span><span class=n>endswith</span><span class=p>(</span><span class=s1>&#39;.xlsx&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>df</span> <span class=o>=</span> <span class=n>read_excel</span><span class=p>(</span><span class=n>file_path</span><span class=p>,</span> <span class=n>engine</span><span class=o>=</span><span class=s1>&#39;openpyxl&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>UnsupportedFormat</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 2. 验证基本结构</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>df</span><span class=o>.</span><span class=n>empty</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>EmptyFileError</span><span class=p>(</span><span class=s2>&#34;文件没有数据&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=o>.</span><span class=n>columns</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>50</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>raise</span> <span class=n>TooManyColumnsError</span><span class=p>(</span><span class=s2>&#34;列数不能超过50&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 3. 数据清洗（逐行处理，更新进度）</span>
</span></span><span class=line><span class=cl>    <span class=n>total_rows</span> <span class=o>=</span> <span class=nb>len</span><span class=p>(</span><span class=n>df</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>error_rows</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=n>cleaned_rows</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>row</span> <span class=ow>in</span> <span class=n>df</span><span class=o>.</span><span class=n>iterrows</span><span class=p>():</span>
</span></span><span class=line><span class=cl>        <span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=c1># 3.1 去除空白</span>
</span></span><span class=line><span class=cl>            <span class=n>cleaned_row</span> <span class=o>=</span> <span class=p>{</span><span class=n>k</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>v</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span> <span class=k>for</span> <span class=n>k</span><span class=p>,</span> <span class=n>v</span> <span class=ow>in</span> <span class=n>row</span><span class=o>.</span><span class=n>items</span><span class=p>()}</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 3.2 类型推断和转换</span>
</span></span><span class=line><span class=cl>            <span class=n>cleaned_row</span> <span class=o>=</span> <span class=n>infer_and_convert_types</span><span class=p>(</span><span class=n>cleaned_row</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=c1># 3.3 业务规则验证</span>
</span></span><span class=line><span class=cl>            <span class=n>validate_business_rules</span><span class=p>(</span><span class=n>cleaned_row</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            <span class=n>cleaned_rows</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>cleaned_row</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>        <span class=k>except</span> <span class=n>ValidationError</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>error_rows</span><span class=o>.</span><span class=n>append</span><span class=p>({</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;row&#34;</span><span class=p>:</span> <span class=n>idx</span> <span class=o>+</span> <span class=mi>2</span><span class=p>,</span>  <span class=c1># Excel行号（跳过表头）</span>
</span></span><span class=line><span class=cl>                <span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>e</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=p>})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># 4. 更新进度（每100行）</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>idx</span> <span class=o>%</span> <span class=mi>100</span> <span class=o>==</span> <span class=mi>0</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>progress</span> <span class=o>=</span> <span class=nb>int</span><span class=p>((</span><span class=n>idx</span> <span class=o>/</span> <span class=n>total_rows</span><span class=p>)</span> <span class=o>*</span> <span class=mi>100</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>update_progress</span><span class=p>(</span><span class=n>dataset_id</span><span class=p>,</span> <span class=n>progress</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>push_websocket_message</span><span class=p>(</span><span class=n>dataset_id</span><span class=p>,</span> <span class=n>progress</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># 5. 返回结果</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ParseResult</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>row_count</span><span class=o>=</span><span class=nb>len</span><span class=p>(</span><span class=n>cleaned_rows</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=n>error_rows</span><span class=o>=</span><span class=n>error_rows</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>cleaned_data</span><span class=o>=</span><span class=n>cleaned_rows</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 复杂度：O(n)，n为行数</span>
</span></span><span class=line><span class=cl><span class=c1># 内存：O(n)，未来可改为流式处理降到O(1)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>规则1：数据验证规则</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 文件层面：
</span></span><span class=line><span class=cl>   - 大小 &lt; 10MB
</span></span><span class=line><span class=cl>   - 格式为 CSV 或 XLSX
</span></span><span class=line><span class=cl>   - 编码为 UTF-8（CSV自动检测）
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>2. 结构层面：
</span></span><span class=line><span class=cl>   - 必须有表头（第一行）
</span></span><span class=line><span class=cl>   - 列数 &lt;= 50
</span></span><span class=line><span class=cl>   - 行数 &lt;= 10万（超过需要分批上传）
</span></span><span class=line><span class=cl>   - 列名不能重复
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>3. 数据层面：
</span></span><span class=line><span class=cl>   - 空值比例 &lt; 30%（否则警告）
</span></span><span class=line><span class=cl>   - 日期格式自动识别（支持 YYYY-MM-DD, MM/DD/YYYY 等）
</span></span><span class=line><span class=cl>   - 数字格式自动识别（处理千分位、货币符号）
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>4. 业务层面：
</span></span><span class=line><span class=cl>   - [根据业务定义的特殊规则]
</span></span><span class=line><span class=cl>   例如：金额字段不能为负数
</span></span></code></pre></td></tr></table></div></div><p><strong>规则2：[其他关键规则]</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[规则描述]
</span></span></code></pre></td></tr></table></div></div><h3 id=35-错误码定义>3.5 错误码定义</h3><div class=table-wrapper><table><thead><tr><th>错误码</th><th>HTTP状态</th><th>含义</th><th>前端处理</th></tr></thead><tbody><tr><td><code>invalid_token</code></td><td>401</td><td>Token无效</td><td>跳转登录页</td></tr><tr><td><code>unsupported_format</code></td><td>400</td><td>文件格式错误</td><td>提示用户检查格式</td></tr><tr><td><code>file_too_large</code></td><td>413</td><td>文件过大</td><td>提示压缩或分割</td></tr><tr><td><code>validation_error</code></td><td>422</td><td>数据验证失败</td><td>显示具体错误行</td></tr><tr><td><code>processing_timeout</code></td><td>500</td><td>处理超时</td><td>允许重试</td></tr><tr><td>[自定义错误码]</td><td>xxx</td><td>[含义]</td><td>[处理方式]</td></tr></tbody></table></div><h3 id=-第3步推演检查>✅ 第3步推演检查</h3><p>AI请帮我验证：</p><ul><li><input disabled type=checkbox> API接口的错误处理是否完备？还有哪些边界情况？</li><li><input disabled type=checkbox> 数据库表结构的索引是否合理？查询性能如何？</li><li><input disabled type=checkbox> 是否有数据竞争问题？（如：并发更新同一条记录）</li><li><input disabled type=checkbox> 前端组件的职责是否清晰？是否过度耦合？</li><li><input disabled type=checkbox> 算法的时间/空间复杂度是否可接受？</li><li><input disabled type=checkbox> 业务规则是否有遗漏或矛盾？</li><li><input disabled type=checkbox> Schema定义是否与前面的需求、设计完全对应？</li></ul><hr><h2 id=第4步代码实现约定>第4步：代码实现约定</h2><blockquote><p><strong>核心问题：如何让代码清晰、一致、可维护？</strong></p></blockquote><p>此处以python作为示例，最终取决于用户希望使用的语言或框架的社区规范</p><h3 id=41-项目结构>4.1 项目结构</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>project</span><span class=o>-</span><span class=n>root</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>backend</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>app</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>main</span><span class=o>.</span><span class=n>py</span>              <span class=c1># FastAPI应用入口</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>config</span><span class=o>.</span><span class=n>py</span>            <span class=c1># 配置管理</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>dependencies</span><span class=o>.</span><span class=n>py</span>      <span class=c1># 依赖注入</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>api</span><span class=o>/</span>                 <span class=c1># API路由层</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>v1</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>auth</span><span class=o>.</span><span class=n>py</span>      <span class=c1># 认证相关</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>datasets</span><span class=o>.</span><span class=n>py</span>  <span class=c1># 数据集CRUD</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>websocket</span><span class=o>.</span><span class=n>py</span> <span class=c1># WebSocket</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>deps</span><span class=o>.</span><span class=n>py</span>          <span class=c1># API依赖（如：get_current_user）</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>models</span><span class=o>/</span>              <span class=c1># 数据模型（SQLAlchemy）</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>user</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>dataset</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>base</span><span class=o>.</span><span class=n>py</span>          <span class=c1># 基类</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>schemas</span><span class=o>/</span>             <span class=c1># Pydantic schemas（数据验证）</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>user</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>dataset</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>common</span><span class=o>.</span><span class=n>py</span>        <span class=c1># 通用类型</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>services</span><span class=o>/</span>            <span class=c1># 业务逻辑层</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>auth_service</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>dataset_service</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>parser_service</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>tasks</span><span class=o>/</span>               <span class=c1># Celery异步任务</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>celery_app</span><span class=o>.</span><span class=n>py</span>    <span class=c1># Celery配置</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>processing</span><span class=o>.</span><span class=n>py</span>    <span class=c1># 文件处理任务</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>core</span><span class=o>/</span>                <span class=c1># 核心工具</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>security</span><span class=o>.</span><span class=n>py</span>      <span class=c1># JWT、密码加密</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>exceptions</span><span class=o>.</span><span class=n>py</span>    <span class=c1># 自定义异常</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>logging</span><span class=o>.</span><span class=n>py</span>       <span class=c1># 日志配置</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>utils</span><span class=o>/</span>               <span class=c1># 通用工具</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>       <span class=err>├──</span> <span class=n>__init__</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>       <span class=err>├──</span> <span class=n>file</span><span class=o>.</span><span class=n>py</span>          <span class=c1># 文件操作</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>       <span class=err>└──</span> <span class=n>validators</span><span class=o>.</span><span class=n>py</span>    <span class=c1># 验证器</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>tests</span><span class=o>/</span>                   <span class=c1># 测试</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>unit</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>integration</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>conftest</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>alembic</span><span class=o>/</span>                 <span class=c1># 数据库迁移</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>versions</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>env</span><span class=o>.</span><span class=n>py</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>requirements</span><span class=o>.</span><span class=n>txt</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>pytest</span><span class=o>.</span><span class=n>ini</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=o>.</span><span class=n>env</span><span class=o>.</span><span class=n>example</span>
</span></span><span class=line><span class=cl><span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>frontend</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>src</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>components</span><span class=o>/</span>          <span class=c1># UI组件</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>FileUploader</span><span class=o>.</span><span class=n>tsx</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>ProcessingStatus</span><span class=o>.</span><span class=n>tsx</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>common</span><span class=o>/</span>          <span class=c1># 通用组件</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>pages</span><span class=o>/</span>               <span class=c1># 页面</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>Dashboard</span><span class=o>.</span><span class=n>tsx</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>DatasetDetail</span><span class=o>.</span><span class=n>tsx</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>Login</span><span class=o>.</span><span class=n>tsx</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>services</span><span class=o>/</span>            <span class=c1># API调用</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>api</span><span class=o>.</span><span class=n>ts</span>           <span class=c1># axios配置</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>authService</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>datasetService</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>hooks</span><span class=o>/</span>               <span class=c1># 自定义hooks</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>useAuth</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>useWebSocket</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>useDataset</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>types</span><span class=o>/</span>               <span class=c1># TypeScript类型</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>user</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>dataset</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>api</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>utils</span><span class=o>/</span>               <span class=c1># 工具函数</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>format</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>validators</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>├──</span> <span class=n>App</span><span class=o>.</span><span class=n>tsx</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>   <span class=err>└──</span> <span class=n>main</span><span class=o>.</span><span class=n>tsx</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>public</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>package</span><span class=o>.</span><span class=n>json</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>├──</span> <span class=n>tsconfig</span><span class=o>.</span><span class=n>json</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=err>└──</span> <span class=n>vite</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>ts</span>
</span></span><span class=line><span class=cl><span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=n>docker</span><span class=o>-</span><span class=n>compose</span><span class=o>.</span><span class=n>yml</span>
</span></span><span class=line><span class=cl><span class=err>├──</span> <span class=o>.</span><span class=n>gitignore</span>
</span></span><span class=line><span class=cl><span class=err>└──</span> <span class=n>README</span><span class=o>.</span><span class=n>md</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=42-代码风格与规范>4.2 代码风格与规范</h3><p><strong>Python（后端）</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 命名约定</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>变量</span><span class=err>、</span><span class=n>函数</span><span class=err>：</span><span class=n>snake_case</span> <span class=p>(</span><span class=n>例</span><span class=p>:</span> <span class=n>user_id</span><span class=p>,</span> <span class=n>get_dataset</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>类</span><span class=err>：</span><span class=n>PascalCase</span> <span class=p>(</span><span class=n>例</span><span class=p>:</span> <span class=n>UserModel</span><span class=p>,</span> <span class=n>DatasetService</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>常量</span><span class=err>：</span><span class=n>UPPER_SNAKE_CASE</span> <span class=p>(</span><span class=n>例</span><span class=p>:</span> <span class=n>MAX_FILE_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>私有成员</span><span class=err>：</span><span class=n>_leading_underscore</span> <span class=p>(</span><span class=n>例</span><span class=p>:</span> <span class=n>_validate</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 类型标注（必须）</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>create_dataset</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>file</span><span class=p>:</span> <span class=n>UploadFile</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>name</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>owner_id</span><span class=p>:</span> <span class=n>UUID</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>db</span><span class=p>:</span> <span class=n>Session</span>
</span></span><span class=line><span class=cl><span class=p>)</span> <span class=o>-&gt;</span> <span class=n>Dataset</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;创建数据集
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Args:
</span></span></span><span class=line><span class=cl><span class=s2>        file: 上传的文件对象
</span></span></span><span class=line><span class=cl><span class=s2>        name: 数据集名称
</span></span></span><span class=line><span class=cl><span class=s2>        owner_id: 所有者ID
</span></span></span><span class=line><span class=cl><span class=s2>        db: 数据库会话
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Returns:
</span></span></span><span class=line><span class=cl><span class=s2>        Dataset: 创建的数据集对象
</span></span></span><span class=line><span class=cl><span class=s2>    
</span></span></span><span class=line><span class=cl><span class=s2>    Raises:
</span></span></span><span class=line><span class=cl><span class=s2>        UnsupportedFormatError: 文件格式不支持
</span></span></span><span class=line><span class=cl><span class=s2>        FileTooLargeError: 文件过大
</span></span></span><span class=line><span class=cl><span class=s2>    &#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>pass</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Docstring格式：Google Style</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 导入顺序：</span>
</span></span><span class=line><span class=cl><span class=c1># 1. 标准库</span>
</span></span><span class=line><span class=cl><span class=c1># 2. 第三方库</span>
</span></span><span class=line><span class=cl><span class=c1># 3. 本地模块</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 行长度：最大 100 字符</span>
</span></span><span class=line><span class=cl><span class=c1># 工具：black, isort, mypy, pylint</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>TypeScript（前端）</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// 命名约定
</span></span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>变量、函数：</span><span class=nx>camelCase</span> <span class=p>(</span><span class=nx>例</span>: <span class=kt>userId</span><span class=p>,</span> <span class=nx>getDataset</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>类、接口、类型：</span><span class=nx>PascalCase</span> <span class=p>(</span><span class=nx>例</span>: <span class=kt>User</span><span class=p>,</span> <span class=nx>DatasetProps</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>常量：</span><span class=nx>UPPER_SNAKE_CASE</span> <span class=p>(</span><span class=nx>例</span>: <span class=kt>MAX_FILE_SIZE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=err>私有成员：#</span><span class=nx>leading_hash</span> <span class=p>(</span><span class=err>例</span><span class=o>:</span> <span class=err>#</span><span class=nx>validate</span><span class=p>)</span> <span class=err>或</span> <span class=nx>_underscore</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 类型定义（必须，避免any）
</span></span></span><span class=line><span class=cl><span class=kr>interface</span> <span class=nx>Dataset</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>id</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>name</span>: <span class=kt>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>status</span><span class=o>:</span> <span class=s1>&#39;pending&#39;</span> <span class=o>|</span> <span class=s1>&#39;processing&#39;</span> <span class=o>|</span> <span class=s1>&#39;completed&#39;</span> <span class=o>|</span> <span class=s1>&#39;failed&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>createdAt</span>: <span class=kt>Date</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>function</span> <span class=nx>uploadFile</span><span class=p>(</span><span class=nx>file</span>: <span class=kt>File</span><span class=p>,</span> <span class=nx>name</span>: <span class=kt>string</span><span class=p>)</span><span class=o>:</span> <span class=nx>Promise</span><span class=p>&lt;</span><span class=nt>Dataset</span><span class=p>&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// 实现
</span></span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 组件Props必须定义interface
</span></span></span><span class=line><span class=cl><span class=kr>interface</span> <span class=nx>FileUploaderProps</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nx>onSuccess</span><span class=o>:</span> <span class=p>(</span><span class=nx>id</span>: <span class=kt>string</span><span class=p>)</span> <span class=o>=&gt;</span> <span class=k>void</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=nx>maxSize?</span>: <span class=kt>number</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 优先使用函数组件 + Hooks
</span></span></span><span class=line><span class=cl><span class=c1>// 工具：ESLint, Prettier, TypeScript strict mode
</span></span></span></code></pre></td></tr></table></div></div><h3 id=43-关键依赖>4.3 关键依赖</h3><p><strong>后端（requirements.txt）</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl># Web框架
</span></span><span class=line><span class=cl>fastapi==0.109.0
</span></span><span class=line><span class=cl>uvicorn[standard]==0.27.0
</span></span><span class=line><span class=cl>pydantic==2.5.0
</span></span><span class=line><span class=cl>pydantic-settings==2.1.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 数据库
</span></span><span class=line><span class=cl>sqlalchemy==2.0.25
</span></span><span class=line><span class=cl>alembic==1.13.1
</span></span><span class=line><span class=cl>psycopg2-binary==2.9.9
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 异步任务
</span></span><span class=line><span class=cl>celery==5.3.4
</span></span><span class=line><span class=cl>redis==5.0.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 认证
</span></span><span class=line><span class=cl>python-jose[cryptography]==3.3.0
</span></span><span class=line><span class=cl>passlib[bcrypt]==1.7.4
</span></span><span class=line><span class=cl>python-multipart==0.0.6
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 文件处理
</span></span><span class=line><span class=cl>pandas==2.1.4
</span></span><span class=line><span class=cl>openpyxl==3.1.2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 工具
</span></span><span class=line><span class=cl>python-dotenv==1.0.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 测试
</span></span><span class=line><span class=cl>pytest==7.4.4
</span></span><span class=line><span class=cl>pytest-asyncio==0.23.3
</span></span><span class=line><span class=cl>httpx==0.26.0
</span></span></code></pre></td></tr></table></div></div><p><strong>前端（package.json）</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;dependencies&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;react&#34;</span><span class=p>:</span> <span class=s2>&#34;^18.2.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;react-dom&#34;</span><span class=p>:</span> <span class=s2>&#34;^18.2.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;react-router-dom&#34;</span><span class=p>:</span> <span class=s2>&#34;^6.21.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;axios&#34;</span><span class=p>:</span> <span class=s2>&#34;^1.6.5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;zustand&#34;</span><span class=p>:</span> <span class=s2>&#34;^4.4.7&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;@tanstack/react-query&#34;</span><span class=p>:</span> <span class=s2>&#34;^5.17.0&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>},</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;devDependencies&#34;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;@types/react&#34;</span><span class=p>:</span> <span class=s2>&#34;^18.2.48&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;@types/react-dom&#34;</span><span class=p>:</span> <span class=s2>&#34;^18.2.18&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;typescript&#34;</span><span class=p>:</span> <span class=s2>&#34;^5.3.3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;vite&#34;</span><span class=p>:</span> <span class=s2>&#34;^5.0.11&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;eslint&#34;</span><span class=p>:</span> <span class=s2>&#34;^8.56.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;prettier&#34;</span><span class=p>:</span> <span class=s2>&#34;^3.1.1&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=44-配置管理>4.4 配置管理</h3><p><strong>环境变量（.env.example）</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 数据库</span>
</span></span><span class=line><span class=cl><span class=nv>DATABASE_URL</span><span class=o>=</span>postgresql://user:password@localhost:5432/dbname
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Redis</span>
</span></span><span class=line><span class=cl><span class=nv>REDIS_URL</span><span class=o>=</span>redis://localhost:6379/0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># JWT</span>
</span></span><span class=line><span class=cl><span class=nv>SECRET_KEY</span><span class=o>=</span>your-secret-key-here
</span></span><span class=line><span class=cl><span class=nv>ALGORITHM</span><span class=o>=</span>HS256
</span></span><span class=line><span class=cl><span class=nv>ACCESS_TOKEN_EXPIRE_MINUTES</span><span class=o>=</span><span class=m>30</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 文件存储</span>
</span></span><span class=line><span class=cl><span class=nv>UPLOAD_DIR</span><span class=o>=</span>/data/uploads
</span></span><span class=line><span class=cl><span class=nv>MAX_FILE_SIZE</span><span class=o>=</span><span class=m>10485760</span>  <span class=c1># 10MB</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Celery</span>
</span></span><span class=line><span class=cl><span class=nv>CELERY_BROKER_URL</span><span class=o>=</span>redis://localhost:6379/0
</span></span><span class=line><span class=cl><span class=nv>CELERY_RESULT_BACKEND</span><span class=o>=</span>redis://localhost:6379/0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 日志</span>
</span></span><span class=line><span class=cl><span class=nv>LOG_LEVEL</span><span class=o>=</span>INFO
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 前端（.env）</span>
</span></span><span class=line><span class=cl><span class=nv>VITE_API_BASE_URL</span><span class=o>=</span>http://localhost:8000/api/v1
</span></span><span class=line><span class=cl><span class=nv>VITE_WS_URL</span><span class=o>=</span>ws://localhost:8000/ws
</span></span></code></pre></td></tr></table></div></div><h3 id=45-错误处理>4.5 错误处理</h3><p><strong>后端统一异常处理</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># core/exceptions.py</span>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>AppException</span><span class=p>(</span><span class=ne>Exception</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;&#34;&#34;应用基础异常&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>message</span><span class=p>:</span> <span class=nb>str</span><span class=p>,</span> <span class=n>code</span><span class=p>:</span> <span class=nb>str</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>message</span> <span class=o>=</span> <span class=n>message</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>code</span> <span class=o>=</span> <span class=n>code</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=o>.</span><span class=n>message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>UnsupportedFormatError</span><span class=p>(</span><span class=n>AppException</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>super</span><span class=p>()</span><span class=o>.</span><span class=fm>__init__</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=n>message</span><span class=o>=</span><span class=s2>&#34;仅支持 .csv 和 .xlsx 文件&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>code</span><span class=o>=</span><span class=s2>&#34;unsupported_format&#34;</span>
</span></span><span class=line><span class=cl>        <span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># main.py 全局异常处理器</span>
</span></span><span class=line><span class=cl><span class=nd>@app.exception_handler</span><span class=p>(</span><span class=n>AppException</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>async</span> <span class=k>def</span> <span class=nf>app_exception_handler</span><span class=p>(</span><span class=n>request</span><span class=p>:</span> <span class=n>Request</span><span class=p>,</span> <span class=n>exc</span><span class=p>:</span> <span class=n>AppException</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>JSONResponse</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=n>status_code</span><span class=o>=</span><span class=mi>400</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>content</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;error&#34;</span><span class=p>:</span> <span class=n>exc</span><span class=o>.</span><span class=n>code</span><span class=p>,</span> <span class=s2>&#34;message&#34;</span><span class=p>:</span> <span class=n>exc</span><span class=o>.</span><span class=n>message</span><span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>前端统一错误处理</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-typescript data-lang=typescript><span class=line><span class=cl><span class=c1>// services/api.ts
</span></span></span><span class=line><span class=cl><span class=nx>axios</span><span class=p>.</span><span class=nx>interceptors</span><span class=p>.</span><span class=nx>response</span><span class=p>.</span><span class=nx>use</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=nx>response</span> <span class=o>=&gt;</span> <span class=nx>response</span><span class=p>,</span>
</span></span><span class=line><span class=cl>  <span class=nx>error</span> <span class=o>=&gt;</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nx>error</span><span class=p>.</span><span class=nx>response</span><span class=o>?</span><span class=p>.</span><span class=nx>status</span> <span class=o>===</span> <span class=mi>401</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=c1>// Token过期，跳转登录
</span></span></span><span class=line><span class=cl>      <span class=nx>navigate</span><span class=p>(</span><span class=s1>&#39;/login&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=kr>const</span> <span class=nx>apiError</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nx>code</span>: <span class=kt>error.response?.data?.error</span> <span class=o>||</span> <span class=s1>&#39;unknown_error&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=nx>message</span>: <span class=kt>error.response?.data?.message</span> <span class=o>||</span> <span class=s1>&#39;请求失败&#39;</span>
</span></span><span class=line><span class=cl>    <span class=p>};</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1>// 统一toast提示
</span></span></span><span class=line><span class=cl>    <span class=nx>toast</span><span class=p>.</span><span class=nx>error</span><span class=p>(</span><span class=nx>apiError</span><span class=p>.</span><span class=nx>message</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nx>Promise</span><span class=p>.</span><span class=nx>reject</span><span class=p>(</span><span class=nx>apiError</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>);</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=46-日志规范>4.6 日志规范</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 日志级别使用</span>
</span></span><span class=line><span class=cl><span class=n>DEBUG</span><span class=p>:</span> <span class=n>详细的调试信息</span><span class=err>（</span><span class=n>生产环境关闭</span><span class=err>）</span>
</span></span><span class=line><span class=cl><span class=n>INFO</span><span class=p>:</span> <span class=n>关键业务流程</span><span class=err>（</span><span class=n>如</span><span class=err>：</span><span class=n>用户登录</span><span class=err>、</span><span class=n>文件上传开始</span><span class=err>）</span>
</span></span><span class=line><span class=cl><span class=n>WARNING</span><span class=p>:</span> <span class=n>异常但可恢复的情况</span><span class=err>（</span><span class=n>如</span><span class=err>：</span><span class=n>重试成功</span><span class=err>）</span>
</span></span><span class=line><span class=cl><span class=n>ERROR</span><span class=p>:</span> <span class=n>错误但不影响整体服务</span><span class=err>（</span><span class=n>如</span><span class=err>：</span><span class=n>单个任务失败</span><span class=err>）</span>
</span></span><span class=line><span class=cl><span class=n>CRITICAL</span><span class=p>:</span> <span class=n>严重错误</span><span class=err>，</span><span class=n>服务不可用</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 示例</span>
</span></span><span class=line><span class=cl><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;Dataset created&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>extra</span><span class=o>=</span><span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;dataset_id&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>dataset</span><span class=o>.</span><span class=n>id</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;owner_id&#34;</span><span class=p>:</span> <span class=nb>str</span><span class=p>(</span><span class=n>owner</span><span class=o>.</span><span class=n>id</span><span class=p>),</span>
</span></span><span class=line><span class=cl>        <span class=s2>&#34;file_size&#34;</span><span class=p>:</span> <span class=n>file</span><span class=o>.</span><span class=n>size</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 敏感信息不记录</span>
</span></span><span class=line><span class=cl><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;User </span><span class=si>{</span><span class=n>user</span><span class=o>.</span><span class=n>username</span><span class=si>}</span><span class=s2> logged in&#34;</span><span class=p>)</span>  <span class=c1># ✅</span>
</span></span><span class=line><span class=cl><span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Password: </span><span class=si>{</span><span class=n>password</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>  <span class=c1># ❌ 绝对禁止</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=-第4步推演检查>✅ 第4步推演检查</h3><p>AI请帮我验证：</p><ul><li><input disabled type=checkbox> 项目结构是否清晰？模块划分是否合理？</li><li><input disabled type=checkbox> 依赖版本是否兼容？是否有安全漏洞？</li><li><input disabled type=checkbox> 错误处理是否完备？用户体验是否友好？</li><li><input disabled type=checkbox> 日志是否足够诊断问题？是否有敏感信息泄露风险？</li><li><input disabled type=checkbox> 配置管理是否安全？是否容易部署到不同环境？</li></ul><hr><h2 id=验证计划>验证计划</h2><blockquote><p><strong>如何确保每一层的设计都正确落地？</strong></p></blockquote><h3 id=需求验证>需求验证</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>方法：用户访谈 + 原型测试
</span></span><span class=line><span class=cl>时间：开发前1周
</span></span><span class=line><span class=cl>验证点：
</span></span><span class=line><span class=cl>  - [ ] 用户故事是否覆盖真实场景
</span></span><span class=line><span class=cl>  - [ ] 产品边界是否被用户接受
</span></span><span class=line><span class=cl>  - [ ] UI/UX是否直观易用
</span></span><span class=line><span class=cl>产出：用户反馈报告，需求调整清单
</span></span></code></pre></td></tr></table></div></div><h3 id=设计验证>设计验证</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>方法：架构评审 + 性能推演
</span></span><span class=line><span class=cl>时间：编码前
</span></span><span class=line><span class=cl>验证点：
</span></span><span class=line><span class=cl>  - [ ] 架构是否支撑非功能性需求（性能、可靠性）
</span></span><span class=line><span class=cl>  - [ ] 是否存在单点故障
</span></span><span class=line><span class=cl>  - [ ] 扩展性是否足够
</span></span><span class=line><span class=cl>产出：架构评审报告，风险清单
</span></span></code></pre></td></tr></table></div></div><h3 id=实现验证>实现验证</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>方法：单元测试 + 集成测试 + E2E测试
</span></span><span class=line><span class=cl>覆盖率目标：
</span></span><span class=line><span class=cl>  - 核心业务逻辑：&gt; 80%
</span></span><span class=line><span class=cl>  - API接口：100%（所有端点和错误码）
</span></span><span class=line><span class=cl>  - 前端组件：&gt; 60%
</span></span><span class=line><span class=cl>关键测试场景：
</span></span><span class=line><span class=cl>  1. 正常流程：上传 → 处理 → 查看结果
</span></span><span class=line><span class=cl>  2. 异常流程：格式错误、超大文件、网络中断、并发冲突
</span></span><span class=line><span class=cl>  3. 性能测试：1000行文件处理时间、10并发上传
</span></span><span class=line><span class=cl>产出：测试报告，bug清单
</span></span></code></pre></td></tr></table></div></div><h3 id=上线验证>上线验证</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>方法：灰度发布 + 监控
</span></span><span class=line><span class=cl>阶段：
</span></span><span class=line><span class=cl>  1. 内部测试（1天）：团队成员使用
</span></span><span class=line><span class=cl>  2. 小范围试点（3天）：5-10个真实用户
</span></span><span class=line><span class=cl>  3. 全量发布
</span></span><span class=line><span class=cl>监控指标：
</span></span><span class=line><span class=cl>  - 错误率 &lt; 1%
</span></span><span class=line><span class=cl>  - API响应时间 P95 &lt; 500ms
</span></span><span class=line><span class=cl>  - 用户反馈 NPS &gt; 7
</span></span><span class=line><span class=cl>回滚策略：如果错误率 &gt; 5%，立即回滚
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=我的设计思路>我的设计思路</h2><h3 id=已经想清楚的部分>已经想清楚的部分</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[描述你脑海中已经完整的设计]
</span></span><span class=line><span class=cl>例如：
</span></span><span class=line><span class=cl>1. 文件上传采用分块上传（前端实现），支持大文件和断点续传
</span></span><span class=line><span class=cl>2. 异步处理使用Celery，worker数量根据队列长度自动伸缩
</span></span><span class=line><span class=cl>3. 进度推送优先使用WebSocket，降级方案是轮询（每2秒）
</span></span><span class=line><span class=cl>4. 数据库索引策略：owner_id + status 复合索引，覆盖&#34;我的数据集&#34;查询
</span></span><span class=line><span class=cl>5. 前端状态管理用Zustand，避免Redux的繁琐
</span></span><span class=line><span class=cl>6. ...
</span></span></code></pre></td></tr></table></div></div><h3 id=需要你帮我推演的部分>需要你帮我推演的部分</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[需要AI帮助深入思考的设计点]
</span></span><span class=line><span class=cl>例如：
</span></span><span class=line><span class=cl>1. 文件解析失败后的重试策略：
</span></span><span class=line><span class=cl>   - 是否需要自动重试？重试几次？
</span></span><span class=line><span class=cl>   - 失败的中间数据如何处理？
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>2. 并发控制：
</span></span><span class=line><span class=cl>   - 如果用户快速上传10个文件，如何排队？
</span></span><span class=line><span class=cl>   - 是否需要限制单用户的并发任务数？
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>3. 缓存策略：
</span></span><span class=line><span class=cl>   - 数据集列表是否需要缓存？缓存多久？
</span></span><span class=line><span class=cl>   - 如何保证缓存一致性？
</span></span></code></pre></td></tr></table></div></div><h3 id=需要你质疑的部分>需要你质疑的部分</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[希望AI重点挑战的设计决策]
</span></span><span class=line><span class=cl>例如：
</span></span><span class=line><span class=cl>1. WebSocket的必要性：
</span></span><span class=line><span class=cl>   - 实时推送的价值是否值得复杂度？
</span></span><span class=line><span class=cl>   - 轮询（每2秒）的用户体验差多少？
</span></span><span class=line><span class=cl>   - WebSocket连接管理、断线重连的成本如何？
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>2. Celery的复杂度：
</span></span><span class=line><span class=cl>   - 对于MVP，是否可以用FastAPI的BackgroundTasks？
</span></span><span class=line><span class=cl>   - 什么时候才真正需要Celery？
</span></span><span class=line><span class=cl>   
</span></span><span class=line><span class=cl>3. 数据存储策略：
</span></span><span class=line><span class=cl>   - 原始文件是否需要长期保留？
</span></span><span class=line><span class=cl>   - 是否应该只保留解析后的结构化数据？
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=风险与应对>风险与应对</h2><h3 id=技术风险>技术风险</h3><p><strong>风险1：大文件处理内存溢出</strong></p><ul><li>概率：中 | 影响：高</li><li>缓解措施：流式读取（chunk-based），限制最大文件10MB</li><li>应急方案：如果内存占用>80%，拒绝新任务</li></ul><p><strong>风险2：数据库连接池耗尽</strong></p><ul><li>概率：低 | 影响：高</li><li>缓解措施：连接池大小=worker数*2，设置超时</li><li>应急方案：增加连接池大小，优化长查询</li></ul><p><strong>风险3：[你识别的风险]</strong></p><ul><li>概率： | 影响：</li><li>缓解措施：</li><li>应急方案：</li></ul><h3 id=业务风险>业务风险</h3><p><strong>风险1：用户不愿改变工作习惯</strong></p><ul><li>概率：中 | 影响：高</li><li>缓解措施：提供详细的onboarding教程，1对1培训</li><li>应急方案：保留Excel导出功能，允许混合使用</li></ul><p><strong>风险2：[业务风险]</strong></p><ul><li>概率： | 影响：</li><li>缓解措施：</li><li>应急方案：</li></ul><hr><h2 id=立即开始的任务>立即开始的任务</h2><h3 id=第一阶段任务优先级p0>第一阶段任务（优先级P0）</h3><p><strong>任务1：搭建项目骨架</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>工作量：2小时
</span></span><span class=line><span class=cl>内容：
</span></span><span class=line><span class=cl>  - 创建目录结构
</span></span><span class=line><span class=cl>  - 配置开发环境（Python venv, Node.js）
</span></span><span class=line><span class=cl>  - 安装核心依赖
</span></span><span class=line><span class=cl>  - 配置 docker-compose（PostgreSQL, Redis）
</span></span><span class=line><span class=cl>验收标准：
</span></span><span class=line><span class=cl>  - 前后端都能启动
</span></span><span class=line><span class=cl>  - 数据库连接成功
</span></span><span class=line><span class=cl>  - API返回&#34;Hello World&#34;
</span></span></code></pre></td></tr></table></div></div><p><strong>任务2：实现用户认证</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>工作量：4小时
</span></span><span class=line><span class=cl>内容：
</span></span><span class=line><span class=cl>  - User模型和数据库表
</span></span><span class=line><span class=cl>  - 注册、登录API
</span></span><span class=line><span class=cl>  - JWT token生成和验证
</span></span><span class=line><span class=cl>  - 前端登录页面和token管理
</span></span><span class=line><span class=cl>验收标准：
</span></span><span class=line><span class=cl>  - 可以注册新用户
</span></span><span class=line><span class=cl>  - 登录后获得token
</span></span><span class=line><span class=cl>  - 受保护的API需要token访问
</span></span></code></pre></td></tr></table></div></div><p><strong>任务3：实现文件上传</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>工作量：</span><span class=mi>6</span><span class=err>小时</span>
</span></span><span class=line><span class=cl><span class=err>内容：</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>Dataset模型和表</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>上传</span><span class=n>API</span><span class=err>（接收文件，保存到本地）</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>Celery配置和测试任务</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>前端</span><span class=n>FileUploader组件</span>
</span></span><span class=line><span class=cl><span class=err>验收标准：</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>可以上传</span><span class=n>CSV</span><span class=o>/</span><span class=n>Excel文件</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=err>文件保存成功，返回</span><span class=n>dataset_id</span>
</span></span><span class=line><span class=cl>  <span class=o>-</span> <span class=n>Celery</span> <span class=n>worker正常运行</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=第二阶段任务优先级p1>第二阶段任务（优先级P1）</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>- 实现文件解析和数据清洗
</span></span><span class=line><span class=cl>- WebSocket实时进度推送
</span></span><span class=line><span class=cl>- 数据集列表和详情页面
</span></span><span class=line><span class=cl>- ...
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=协作约定>协作约定</h2><h3 id=沟通协议>沟通协议</h3><p><strong>当你（AI）不确定时</strong>：</p><ul><li>❌ 不要猜测我的意图</li><li>✅ 明确指出你的困惑，提出2-3个可能的理解，让我选择</li></ul><p><strong>当你发现问题时</strong>：</p><ul><li>❌ 不要沉默地"照做&rdquo;</li><li>✅ 先说"我发现一个问题：[描述]，建议[方案]，你怎么看？&rdquo;</li></ul><p><strong>当我给出设计时</strong>：</p><ul><li>❌ 不要立即开始写代码</li><li>✅ 先复述你的理解，等我确认后再行动</li></ul><h3 id=工作流程>工作流程</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1. 我提供设计（或填写模板）
</span></span><span class=line><span class=cl>   ↓
</span></span><span class=line><span class=cl>2. 你复述理解 + 推演验证 + 提出质疑
</span></span><span class=line><span class=cl>   ↓
</span></span><span class=line><span class=cl>3. 我们讨论并达成共识
</span></span><span class=line><span class=cl>   ↓
</span></span><span class=line><span class=cl>4. 你高效实现（此时才开始写代码）
</span></span><span class=line><span class=cl>   ↓
</span></span><span class=line><span class=cl>5. 完成后，我们回顾是否符合设计
</span></span><span class=line><span class=cl>   ↓
</span></span><span class=line><span class=cl>6. 发现偏差 → 调整实现（而非修改设计）
</span></span></code></pre></td></tr></table></div></div><h3 id=质量检查清单>质量检查清单</h3><p><strong>每次提交代码前</strong>：</p><ul><li><input disabled type=checkbox> 通过linter检查（black, mypy, eslint）</li><li><input disabled type=checkbox> 核心函数有类型标注和docstring</li><li><input disabled type=checkbox> 关键业务逻辑有单元测试</li><li><input disabled type=checkbox> 错误处理完善（不会裸露异常）</li><li><input disabled type=checkbox> 敏感信息已移除（密码、token）</li><li><input disabled type=checkbox> 符合"定义文档层"的API/Schema定义</li></ul><hr><h2 id=开始协作>开始协作</h2><h3 id=ai请确认你理解了>AI，请确认你理解了：</h3><ol><li>✅ 我是程序设计师，编码前已经想清楚了设计</li><li>✅ 我们的共识路径是五层（意图→需求→设计→定义→实现）</li><li>✅ 你的角色是推演、质疑、落实，而非决策</li><li>✅ 当设计不清晰时，你应该提问而非猜测</li><li>✅ 代码是设计的表达，必须严格遵循"定义文档层"</li></ol><h3 id=开始工作>开始工作</h3><p><strong>请先做这件事</strong>：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>阅读上面我填写的所有内容，然后：
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1. 用一段话总结你对项目的理解（意图、目标、架构）
</span></span><span class=line><span class=cl>2. 列出你发现的3-5个潜在问题或风险
</span></span><span class=line><span class=cl>3. 针对&#34;需要你质疑的部分&#34;，给出你的分析
</span></span><span class=line><span class=cl>4. 确认第一阶段的任务清单，询问是否可以开始
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>只有得到我的明确确认后，才开始写第一行代码。
</span></span></code></pre></td></tr></table></div></div></section><footer class=article-footer><section class=article-tags><a href=/tags/ai/>AI</a>
<a href=/tags/%E6%8F%90%E7%A4%BA%E8%AF%8D/>提示词</a></section><section class=article-copyright><svg class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-content--wrapper><h2 class=section-title>相关文章</h2><div class=related-content><div class="flex article-list--tile"><article><a href=/p/26-key-points-for-developing-agents/><div class=article-details><h2 class=article-title>[AI Agent]开发智能体的26个关键要点</h2></div></a></article><article><a href=/p/claude_agent_sdk_technical_specification/><div class=article-details><h2 class=article-title>【AI】转载 Claude Agent SDK 技术规格说明</h2></div></a></article><article><a href=/p/openai-use-opentelemetry/><div class=article-details><h2 class=article-title>【AI】OpenAI 使用 Opentelemetry 进行链路监控</h2></div></a></article><article><a href=/p/analysis-system-business/><div class=article-details><h2 class=article-title>[Prompt]使用AI分析系统的业务逻辑和架构</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2017 -
2026 雨的味道</section><section class=powerby><a style=display:none href=https://beian.miit.gov.cn/ target=_blank>晋ICP备15000230号-1</a><br>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.33.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.c922af694cc257bf1ecc41c0dd7b0430f9114ec280ccf67cd2c6ad55f5316c4e.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>